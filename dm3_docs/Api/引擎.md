# 引擎

## 属性

### 系统信息

- 类型：table
- 读写：只读
- 详情：当前系统信息。

| 名称 | 类型 | 说明 |
| --- | --- | --- |
| `标题` | 文本 | 游戏窗口标题 |
| `桌面宽度` | 数值 | 桌面分辨率宽度 |
| `桌面高度` | 数值 | 桌面分辨率高度 |
| `桌面鼠标x` | 数值 | 桌面上鼠标坐标x |
| `桌面鼠标y` | 数值 | 桌面上鼠标坐标y |
| `屏幕坐标x` | 数值 | 游戏窗口在桌面上的坐标x |
| `屏幕坐标y` | 数值 | 游戏窗口在桌面上的坐标y |
| `屏幕宽度` | 数值 | 游戏窗口宽度 |
| `屏幕高度` | 数值 | 游戏窗口高度 |
| `屏幕鼠标x` | 数值 | 游戏窗口上鼠标坐标x |
| `屏幕鼠标y` | 数值 | 游戏窗口上鼠标坐标y |
| `运行模式` | 数值 | `0` 调试模式 `1` 打包模式 `2` 盒子模式 |
| `运行时间` | 整数 | 本次游戏启动后运行的时长，单位：毫秒 |

```
调试输出(引擎.系统信息)

{
 名称 = "调试标签",
 类型 = "标签",
 x = 40,
 y = 40,
 宽度 = 600,
 高度 = 30,
 水平对齐 = 0,
 垂直对齐 = 1,
 字体 = "宋体12",
 标题 = "桌面：&桌面宽度&x&桌面高度& &桌面鼠标x&,&桌面鼠标y& 屏幕：&屏幕宽度&x&屏幕高度& (&屏幕坐标x&x&屏幕坐标y&) &屏幕鼠标x&,&屏幕鼠标y& ",
 边框宽度 = 1,
 边框色 = RGBA(255,255,0,255),
 文本色 = RGBA(255,255,255,255),
 描边色 = RGBA(0,0,200,200),
 背景色 = RGBA(0,200,0,200),
 数据源 = 引擎.系统信息,
},

```

### 平台信息

- 类型：table
- 详情：登录微信,从游戏盒子进入游戏后,可以取出账号相关信息。

| 名称 | 类型 | 权限 | 说明 |
| --- | --- | --- | --- |
| `玩家账号` | 文本/nil | 只读 | 玩家盒子标识 未登录：nil |
| `玩家昵称` | 文本/nil | 只读 | 玩家游戏盒子里的昵称 未登录：nil |
| `玩家头像` | 文本/nil | 只读 | 玩家游戏盒子里的头像 未登录：nil |
| `今日签到` | 整数 | 只读 | 0：未签到 1：签到 |
| `连续签到` | 整数 | 只读 | 连续签到次数 |
| `今日投币` | 整数 | 只读 | 今日是否为当前游戏投币 0：未投 1：已投 |
| `累计投币` | 整数 | 只读 | 累计为当前游戏投币总数 |
| `剩余金币` | 整数 | 只读 | 当前玩家剩余多少金币 |
| `附加` | table {整数} | 读写 | 每个账号可以储存5个整数型变量,变动后会自动同步到平台 后台设置排行策略,在盒子页面的排行榜显示 |

```
调试输出(引擎.平台信息)
引擎.平台信息.附加[1] = 66; -- 平台会自动储存 后台可见

```

### 地图

- 类型：地图对象
- 读写：只读
- 详情：地图是常用组件,你可以在脚本中使用引擎.地图获得当前的地图对象

### 道具

- 类型：道具对象
- 读写：读写
- 详情：你可以在脚本中使用 引擎.道具.xxxx 快速读写指定道具项目默认配置项。

| 属性 | 类型 | 权限 |
| --- | --- | --- |
| `名称` | 文本 | 只读 |
| `显示名` | 文本 | 只读 |
| `颜色` | RGBA | 只读 |
| `等级` | 整数 | 只读 |
| `分类` | 文本 | 只读 |
| `子类` | 文本 | 只读 |
| `图标` | 文本 | 只读 |
| `最大叠加` | 整数 | 只读 |
| `hp,mp,自定义属性...` | 整数 | 只读 |
| `附加` | table | 读写 |
| `气泡提示` | table | 读写 |

```
local 道具信息 = 引擎.道具["新装备武器"]
if (道具信息 == nil) then
 调试输出("没有这件装备")
 return
end

道具信息 = 引擎.道具["短剑"]
调试输出(道具信息.名称,道具信息.显示名,道具信息.等级,道具信息.maxhp,道具信息.暴击)
道具信息.气泡提示 = "#Y一把超级大短剑" -- 修改默认气泡

```

### 菜单

- 类型：菜单对象
- 读写：读写
- 详情：菜单是常用组件,你可以在脚本中使用引擎.菜单.xxxx快速读写指定菜单项目属性,[标题][可视][选中][禁用]
- 菜单拥有重置方法,可以动态改变菜单内容。

```
调试输出(引擎.菜单.物件菜单)
引擎.菜单.物件菜单.网格对齐.选中 = true -- 允许直接修改子菜单属性

引擎.菜单.测试菜单.重置({
	{名称="复制",标题="复制",可视=true,选中=false,禁用=false},
	{名称="删除",标题="删除",可视=true,选中=false,禁用=false}
})

```

### 鼠标道具

- 类型：道具对象
- 读写：只读
- 详情：当前鼠标上拿起的道具对象,如果没有道具,则为nil

```
点击 = function(角色对象,键值,功能键)
 local 鼠标道具 = 引擎.鼠标道具
 if (鼠标道具) then
 if (鼠标道具.名称 == "木剑") then
 鼠标道具.数量 = 0
 引擎.屏幕提示("#Y" .. 鼠标道具.显示名 .. "很好吃!我的攻击力变得更强了!" ,{x =0,y=-60,弹簧效果=false},角色对象)
 else
 引擎.屏幕提示("我不吃 " .. 鼠标道具.显示名 ,{x =0,y=-60,弹簧效果=false},角色对象)
 end
 end
 return true
end,

```

### 鼠标技能

- 类型：文本
- 读写：只读
- 详情：当前鼠标上拿起的技能名称,如果没有技能,则为nil

### 鼠标角色

- 类型：角色对象
- 读写：只读
- 详情：在地图上当前鼠标位置是否有角色对象,如果没有角色,则为nil

### 鼠标指针

- 类型：整数/文本
- 读写：读写
- 详情：设置鼠标指针样式,文本型时填写组件名称添加指针。

| 样式值 | 说明 |
| --- | --- |
| -1 | 隐藏鼠标指针 |
| 0 | 箭头光标（默认） |
| 1 | 忙碌箭头光标 |
| 2 | 忙碌状态光标 |
| 3 | I型文本输入光标 |
| 4 | 手形指针光标 |
| 5 | 水平双向调整光标 |
| 6 | 垂直双向调整光标 |
| 7 | 左上-右下双向调整光标 |
| 8 | 左下-右上双向调整光标 |
| 9 | 左向箭头光标 |
| 10 | 右向箭头光标 |
| 11 | 上向箭头光标 |
| 12 | 下向箭头光标 |
| 13 | 左上箭头光标 |
| 14 | 右下箭头光标 |
| 15 | 左下箭头光标 |
| 16 | 右上箭头光标 |
| 17 | 全向调整光标 |
| 18 | 十字准星光标 |
| 19 | 帮助问号光标 |
| 20 | 禁止操作光标 |

## 方法

### 系统设置

说明：动态修改系统配置。

参数名称 值的类型 是否必填 说明描述 配置项 table false 参数名称 值的类型 是否必填 说明描述 x 整数 false 窗口坐标x y 整数 false 窗口坐标y 宽度 整数 false 窗口宽度 高度 整数 false 窗口高度 标题 文本 false 窗口标题 位置 整数 false `-1：桌面置底` `1：桌面置顶` `2：最小化` 音量 整数 false 范围：0-100 整体控制游戏中的音效音量 不包含音乐,音乐对象的音量需要自己单独控制 调试键 {键值,功能键} false 默认：{96,0} `功能键：0:无 1:Alt 2:Ctrl 4:Shift ` 键值：-1表示不启用 老板键 {键值,功能键} false 默认：{-1,0} `功能键：0:无 1:Alt 2:Ctrl 4:Shift ` 键值：-1表示不启用 键盘控制 {启用=false,上=22,下=18,左=0,右=3} false 键盘控制角色移动,上下左右为四个键值,默认不启用 物品名可视 逻辑 false 地面物品名称是否持续可见 默认： `false` 角色血条 整数 false `0：不显示` `1：合并显示 (默认)` `2：独立显示` 角色名称 整数 false `0：不显示` `1：合并显示 (默认)` `2：独立显示` 示例 `引擎.系统设置({宽度 = 800,高度 = 600,标题 = "我的游戏"})`

引擎.系统设置({标题 = os.date("%Y-%m-%d %H:%M:%S",os.time())}) -- 只修改标题
引擎.系统设置({老板键 = {64,0},调试键={-1,0}}) -- 设置 Home 老板键 取消默认的F12调试键

引擎.系统设置({ 键盘控制 = {启用=true,上=22,下=18,左=0,右=3} }) -- WASD

| 返回值 | 值的类型 | 说明描述 |
| --- | --- | --- |
| 是否成功 | 逻辑 | 设置老板键时有可能设置失败 |

| 参数名称 | 值的类型 | 是否必填 | 说明描述 |
| --- | --- | --- | --- |
| 配置项 | table | false | 参数名称 值的类型 是否必填 说明描述 x 整数 false 窗口坐标x y 整数 false 窗口坐标y 宽度 整数 false 窗口宽度 高度 整数 false 窗口高度 标题 文本 false 窗口标题 位置 整数 false `-1：桌面置底` `1：桌面置顶` `2：最小化` 音量 整数 false 范围：0-100 整体控制游戏中的音效音量 不包含音乐,音乐对象的音量需要自己单独控制 调试键 {键值,功能键} false 默认：{96,0} `功能键：0:无 1:Alt 2:Ctrl 4:Shift ` 键值：-1表示不启用 老板键 {键值,功能键} false 默认：{-1,0} `功能键：0:无 1:Alt 2:Ctrl 4:Shift ` 键值：-1表示不启用 键盘控制 {启用=false,上=22,下=18,左=0,右=3} false 键盘控制角色移动,上下左右为四个键值,默认不启用 物品名可视 逻辑 false 地面物品名称是否持续可见 默认： `false` 角色血条 整数 false `0：不显示` `1：合并显示 (默认)` `2：独立显示` 角色名称 整数 false `0：不显示` `1：合并显示 (默认)` `2：独立显示` |

| 参数名称 | 值的类型 | 是否必填 | 说明描述 |
| --- | --- | --- | --- |
| x | 整数 | false | 窗口坐标x |
| y | 整数 | false | 窗口坐标y |
| 宽度 | 整数 | false | 窗口宽度 |
| 高度 | 整数 | false | 窗口高度 |
| 标题 | 文本 | false | 窗口标题 |
| 位置 | 整数 | false | `-1：桌面置底` `1：桌面置顶` `2：最小化` |
| 音量 | 整数 | false | 范围：0-100 整体控制游戏中的音效音量 不包含音乐,音乐对象的音量需要自己单独控制 |
| 调试键 | {键值,功能键} | false | 默认：{96,0} `功能键：0:无 1:Alt 2:Ctrl 4:Shift ` 键值：-1表示不启用 |
| 老板键 | {键值,功能键} | false | 默认：{-1,0} `功能键：0:无 1:Alt 2:Ctrl 4:Shift ` 键值：-1表示不启用 |
| 键盘控制 | {启用=false,上=22,下=18,左=0,右=3} | false | 键盘控制角色移动,上下左右为四个键值,默认不启用 |
| 物品名可视 | 逻辑 | false | 地面物品名称是否持续可见 默认： `false` |
| 角色血条 | 整数 | false | `0：不显示` `1：合并显示 (默认)` `2：独立显示` |
| 角色名称 | 整数 | false | `0：不显示` `1：合并显示 (默认)` `2：独立显示` |

## 示例

```
引擎.系统设置({宽度 = 800,高度 = 600,标题 = "我的游戏"})
引擎.系统设置({标题 = os.date("%Y-%m-%d %H:%M:%S",os.time())}) -- 只修改标题
引擎.系统设置({老板键 = {64,0},调试键={-1,0}}) -- 设置 Home 老板键 取消默认的F12调试键

引擎.系统设置({ 键盘控制 = {启用=true,上=22,下=18,左=0,右=3} }) -- WASD

```

| 返回值 | 值的类型 | 说明描述 |
| --- | --- | --- |
| 是否成功 | 逻辑 | 设置老板键时有可能设置失败 |

### 屏幕提示

说明：在屏幕上显示一个提示。

参数名称 值的类型 是否必填 说明描述 内容 文本 true 支持丰富文本 属性表 table false 参数名称 值的类型 是否必填 说明描述 x 整数 false 显示坐标x y 整数 false 显示坐标y 行距 整数 false 两次提示间的间隔距离 默认:2 气泡皮肤 文本 false 气泡皮肤名称 对齐方式 整数 false 0 左对齐 1 居中对齐 2 右对齐 动画效果 整数 false 0 直接显示 1 渐入 2 弹簧 默认:1 停留时间 整数 false 单位:毫秒 默认:1000 限制宽度 整数 false 自动换行的宽度 默认:-1 不自动换行 打字间隔 整数 false 是否使用打字效果,越大越慢, 默认：0，无打字效果。 分组 文本 false 不同分组的提示会显示在一起 清空分组 逻辑 false 是否清空分组内的所有提示 默认:false 目标对象 对象 false 显示在哪? 如果不填表示屏幕最顶层 示例 `引擎.屏幕提示("#Y游戏开始了") `

引擎.屏幕提示("+123",{分组 = "法力恢复", x = 740,y = 652, 气泡皮肤="道具气泡",对齐方式=1})
引擎.屏幕提示("+123",{分组 = "生命恢复", x = 280,y = 652, 气泡皮肤="道具气泡",对齐方式=1})

| 参数名称 | 值的类型 | 是否必填 | 说明描述 |
| --- | --- | --- | --- |
| 内容 | 文本 | true | 支持丰富文本 |
| 属性表 | table | false | 参数名称 值的类型 是否必填 说明描述 x 整数 false 显示坐标x y 整数 false 显示坐标y 行距 整数 false 两次提示间的间隔距离 默认:2 气泡皮肤 文本 false 气泡皮肤名称 对齐方式 整数 false 0 左对齐 1 居中对齐 2 右对齐 动画效果 整数 false 0 直接显示 1 渐入 2 弹簧 默认:1 停留时间 整数 false 单位:毫秒 默认:1000 限制宽度 整数 false 自动换行的宽度 默认:-1 不自动换行 打字间隔 整数 false 是否使用打字效果,越大越慢, 默认：0，无打字效果。 分组 文本 false 不同分组的提示会显示在一起 清空分组 逻辑 false 是否清空分组内的所有提示 默认:false |
| 目标对象 | 对象 | false | 显示在哪? 如果不填表示屏幕最顶层 |

| 参数名称 | 值的类型 | 是否必填 | 说明描述 |
| --- | --- | --- | --- |
| x | 整数 | false | 显示坐标x |
| y | 整数 | false | 显示坐标y |
| 行距 | 整数 | false | 两次提示间的间隔距离 默认:2 |
| 气泡皮肤 | 文本 | false | 气泡皮肤名称 |
| 对齐方式 | 整数 | false | 0 左对齐 1 居中对齐 2 右对齐 |
| 动画效果 | 整数 | false | 0 直接显示 1 渐入 2 弹簧 默认:1 |
| 停留时间 | 整数 | false | 单位:毫秒 默认:1000 |
| 限制宽度 | 整数 | false | 自动换行的宽度 默认:-1 不自动换行 |
| 打字间隔 | 整数 | false | 是否使用打字效果,越大越慢, 默认：0，无打字效果。 |
| 分组 | 文本 | false | 不同分组的提示会显示在一起 |
| 清空分组 | 逻辑 | false | 是否清空分组内的所有提示 默认:false |

## 示例

```
引擎.屏幕提示("#Y游戏开始了")
引擎.屏幕提示("+123",{分组 = "法力恢复", x = 740,y = 652, 气泡皮肤="道具气泡",对齐方式=1})
引擎.屏幕提示("+123",{分组 = "生命恢复", x = 280,y = 652, 气泡皮肤="道具气泡",对齐方式=1})

```

### 弹出文字

说明：弹出一个动感艺术字。

参数名称 值的类型 是否必填 说明描述 x 整数 true x坐标偏移 y 整数 true y坐标偏移 内容 文本 true 艺术字 文本 true 资源标识 目标对象 对象 false 显示在哪? 如果不填表示屏幕最顶层 属性表 table false 参数名称 值的类型 是否必填 说明描述 颜色 RGBA false 间距 整数 false 缩放 数值 false 缩放比例 平滑 逻辑 false 缩放时是否启用平滑效果 默认：false 动效 整数 false 0-3 内置4种模式 延迟 整数 false 延迟时间 示例 `引擎.弹出文字(512,300,tostring(math.random(111,999)) ,"艺术字1");`

引擎.弹出文字(0,-70,tostring(math.random(111,999)) ,"艺术字1",引擎.地图.主角,{颜色=RGBA(0,255,0,255),动效=3});

| 参数名称 | 值的类型 | 是否必填 | 说明描述 |
| --- | --- | --- | --- |
| x | 整数 | true | x坐标偏移 |
| y | 整数 | true | y坐标偏移 |
| 内容 | 文本 | true | |
| 艺术字 | 文本 | true | 资源标识 |
| 目标对象 | 对象 | false | 显示在哪? 如果不填表示屏幕最顶层 |
| 属性表 | table | false | 参数名称 值的类型 是否必填 说明描述 颜色 RGBA false 间距 整数 false 缩放 数值 false 缩放比例 平滑 逻辑 false 缩放时是否启用平滑效果 默认：false 动效 整数 false 0-3 内置4种模式 延迟 整数 false 延迟时间 |

| 参数名称 | 值的类型 | 是否必填 | 说明描述 |
| --- | --- | --- | --- |
| 颜色 | RGBA | false | |
| 间距 | 整数 | false | |
| 缩放 | 数值 | false | 缩放比例 |
| 平滑 | 逻辑 | false | 缩放时是否启用平滑效果 默认：false |
| 动效 | 整数 | false | 0-3 内置4种模式 |
| 延迟 | 整数 | false | 延迟时间 |

## 示例

```
引擎.弹出文字(512,300,tostring(math.random(111,999)) ,"艺术字1");
引擎.弹出文字(0,-70,tostring(math.random(111,999)) ,"艺术字1",引擎.地图.主角,{颜色=RGBA(0,255,0,255),动效=3});

```

### 转场动画

说明：显示一个转场过渡效果。

参数名称 值的类型 是否必填 说明描述 花费时间 整数 true 多少毫秒内完成 转场效果 整数 false 缺省值：1 0 圆形过渡 1 淡入淡出 2 横向擦除 3 菱形过渡 4 随机像素溶解 回调函数 function false 转场后触发函数 地图转场 逻辑 false 是否只针对地图场景转场 默认：false 半场模式 逻辑 false 是否只显示后半场过渡 默认：false 示例 `引擎.转场动画(1000,0) `

引擎.转场动画(1000,0,nil,false,true) -- 仅显示后半段过渡效果

| 参数名称 | 值的类型 | 是否必填 | 说明描述 |
| --- | --- | --- | --- |
| 花费时间 | 整数 | true | 多少毫秒内完成 |
| 转场效果 | 整数 | false | 缺省值：1 0 圆形过渡 1 淡入淡出 2 横向擦除 3 菱形过渡 4 随机像素溶解 |
| 回调函数 | function | false | 转场后触发函数 |
| 地图转场 | 逻辑 | false | 是否只针对地图场景转场 默认：false |
| 半场模式 | 逻辑 | false | 是否只显示后半场过渡 默认：false |

- 0 圆形过渡
- 1 淡入淡出
- 2 横向擦除
- 3 菱形过渡
- 4 随机像素溶解

## 示例

```
引擎.转场动画(1000,0)

引擎.转场动画(1000,0,nil,false,true) -- 仅显示后半段过渡效果

```

### 播放特效

说明：在指定位置播放一个特效。

参数名称 值的类型 是否必填 说明描述 x 整数 true x坐标偏移 y 整数 true y坐标偏移 特效配置 table {} true 特效类型 例子 说明描述 音效 {延迟=200,音效={"雷电术_结束"}} 名称 类型 说明描述 音效 table{} 一个由音效资源名组成的数组,随机播放其中一个 音量 整数 音量大小：0-100 默认：100。可选 音高 小数 越大声音越尖锐,默认：1.0。可选 播放音效 动画 {延迟=200,动画="雷电术,命中,0.5"}, 名称 类型 说明描述 动画 文本 动画写法：动画,动作,缩放,速度,位置 x 整数 可选 y 整数 可选 如果配置x,y会覆盖掉接口参数中坐标 Call {延迟=200,Call=function(tbl) 调试输出("触发了",tbl) end,附加={1,2,3}}, 名称 类型 说明描述 Call function 附加 通用 触发时候,会做为Call的回调参数进行传递 触发一个自定义函数 破碎 {延迟=200,破碎={图片="半兽人",数量= 20,缩放= 0.8,力量 = 1.6,效果=1}}, 名称 类型 说明描述 效果 整数 0：向上抛出 1：中心炸开 2：角度冲击 数量 整数 碎片数量 默认：20 缩放 小数 缩放比例 默认：0.8 力量 小数 破碎爆出力度 范围：0.3-2.0 默认：0.6 地平线 数值 效果1时有效,设置碎片落地的y轴坐标 地平线偏移 数值 效果1时有效,碎片落地的y坐标是否具有随机性 发力点x 数值 效果2时有效,设置发力点坐标 发力点y 数值 效果2时有效,设置发力点坐标 同步消失 逻辑 是否全部碎片都停止后才开始消失 默认：false 在目标点产生随机撕裂图片效果 抖动 {延迟=0,抖动={时间=2000,幅度=10,对象=引擎.窗口.底部UI.动画框1}}, 名称 类型 说明描述 对象 组件对象 要被抖动的对象 时间 整数 持续时间 单位：毫秒 幅度 整数 抖动幅度 指定对象发生抖动效果 闪电链 名称 类型 说明描述 起点x 数值 起点坐标 起点y 数值 终点x 数值 终点坐标 终点y 数值 持续时间 整数 单位：毫秒 默认：1000 节点数量 整数 默认：30 抖动幅度 整数 数值越大越剧烈 默认：100 宽度 数值 默认：2.5 颜色 RGBA 默认：RGBA(100, 180, 255,255) 光晕色 RGBA 默认：RGBA(100, 180, 255,80) 渐入 整数 默认：200 渐出 整数 默认：200 末端变细 逻辑 在两点之间产生闪电链效果 图层 目标为角色时： `0` 身后 `1` 身前 默认： `1` 目标为地图时： `0` 地表 `1` 顶层 默认： `1` 动画时有效 目标对象 对象 false 显示在哪? 如果不填表示屏幕最顶层 示例 `引擎.播放特效(512,100,{{延迟=200,音效={"雷电术_结束"}},{延迟=200,动画="雷电术,命中"}}) `

引擎.播放特效(200,200,{{延迟=200,音效={"雷电术_结束"}},{延迟=200,动画="雷电术,命中"}},引擎.窗口.技能窗口)
引擎.播放特效(0,0,{{延迟=200,音效={"升级光"}},{延迟=200,动画="__测试动画_,升级地,1,1",图层=0}},引擎.地图.主角)
引擎.播放特效(0,0,{{延迟=0,抖动={时间=2000,幅度=10,对象=引擎.窗口.底部UI.动画框1}}})
引擎.播放特效(0,0,{{延迟=0,音量=50,音效={"移动1","移动2"}}}

引擎.播放特效(200,200,
{
 {延迟=0,闪电链={起点x = 50,起点y = 50,终点x = 250,终点y = 50,持续时间 = 2000,宽度 = 1,颜色 = RGBA(240, 240, 240,255),
 光晕色 = RGBA(0, 0,255,255),渐入 = 100,渐出 = 100,节点数量 = 16,末端变细 = false}},
},按钮对象.父窗口)

{
 名称 = "测试按钮",
 类型 = "按钮",
 x = 40,
 y = 550,
 宽度 = 80,
 高度 = 40,
 标题 = "测试",
 系统事件 = {
 点击 = function(按钮对象)
 引擎.播放特效(400,300,{
 {
 延迟=0,
 破碎={
 图片="牌背面",
 数量=20,
 缩放=0.8,
 力量 = 1.6,
 效果=2,
 发力点x = 300, -- 从坐标300,300位置产生力量撕碎图片抛出。
 发力点y = 300,
 }
 }
 })
 end
 }
},

| 参数名称 | 值的类型 | 是否必填 | 说明描述 |
| --- | --- | --- | --- |
| x | 整数 | true | x坐标偏移 |
| y | 整数 | true | y坐标偏移 |
| 特效配置 | table {} | true | 特效类型 例子 说明描述 音效 {延迟=200,音效={"雷电术_结束"}} 名称 类型 说明描述 音效 table{} 一个由音效资源名组成的数组,随机播放其中一个 音量 整数 音量大小：0-100 默认：100。可选 音高 小数 越大声音越尖锐,默认：1.0。可选 播放音效 动画 {延迟=200,动画="雷电术,命中,0.5"}, 名称 类型 说明描述 动画 文本 动画写法：动画,动作,缩放,速度,位置 x 整数 可选 y 整数 可选 如果配置x,y会覆盖掉接口参数中坐标 Call {延迟=200,Call=function(tbl) 调试输出("触发了",tbl) end,附加={1,2,3}}, 名称 类型 说明描述 Call function 附加 通用 触发时候,会做为Call的回调参数进行传递 触发一个自定义函数 破碎 {延迟=200,破碎={图片="半兽人",数量= 20,缩放= 0.8,力量 = 1.6,效果=1}}, 名称 类型 说明描述 效果 整数 0：向上抛出 1：中心炸开 2：角度冲击 数量 整数 碎片数量 默认：20 缩放 小数 缩放比例 默认：0.8 力量 小数 破碎爆出力度 范围：0.3-2.0 默认：0.6 地平线 数值 效果1时有效,设置碎片落地的y轴坐标 地平线偏移 数值 效果1时有效,碎片落地的y坐标是否具有随机性 发力点x 数值 效果2时有效,设置发力点坐标 发力点y 数值 效果2时有效,设置发力点坐标 同步消失 逻辑 是否全部碎片都停止后才开始消失 默认：false 在目标点产生随机撕裂图片效果 抖动 {延迟=0,抖动={时间=2000,幅度=10,对象=引擎.窗口.底部UI.动画框1}}, 名称 类型 说明描述 对象 组件对象 要被抖动的对象 时间 整数 持续时间 单位：毫秒 幅度 整数 抖动幅度 指定对象发生抖动效果 闪电链 名称 类型 说明描述 起点x 数值 起点坐标 起点y 数值 终点x 数值 终点坐标 终点y 数值 持续时间 整数 单位：毫秒 默认：1000 节点数量 整数 默认：30 抖动幅度 整数 数值越大越剧烈 默认：100 宽度 数值 默认：2.5 颜色 RGBA 默认：RGBA(100, 180, 255,255) 光晕色 RGBA 默认：RGBA(100, 180, 255,80) 渐入 整数 默认：200 渐出 整数 默认：200 末端变细 逻辑 在两点之间产生闪电链效果 图层 目标为角色时： `0` 身后 `1` 身前 默认： `1` 目标为地图时： `0` 地表 `1` 顶层 默认： `1` 动画时有效 |
| 目标对象 | 对象 | false | 显示在哪? 如果不填表示屏幕最顶层 |

| 特效类型 | 例子 | 说明描述 |
| --- | --- | --- |
| 音效 | {延迟=200,音效={"雷电术_结束"}} 名称 类型 说明描述 音效 table{} 一个由音效资源名组成的数组,随机播放其中一个 音量 整数 音量大小：0-100 默认：100。可选 音高 小数 越大声音越尖锐,默认：1.0。可选 | 名称 |
| 动画 | {延迟=200,动画="雷电术,命中,0.5"}, 名称 类型 说明描述 动画 文本 动画写法：动画,动作,缩放,速度,位置 x 整数 可选 y 整数 可选 | 名称 |
| Call | {延迟=200,Call=function(tbl) 调试输出("触发了",tbl) end,附加={1,2,3}}, 名称 类型 说明描述 Call function 附加 通用 触发时候,会做为Call的回调参数进行传递 | 名称 |
| 破碎 | {延迟=200,破碎={图片="半兽人",数量= 20,缩放= 0.8,力量 = 1.6,效果=1}}, 名称 类型 说明描述 效果 整数 0：向上抛出 1：中心炸开 2：角度冲击 数量 整数 碎片数量 默认：20 缩放 小数 缩放比例 默认：0.8 力量 小数 破碎爆出力度 范围：0.3-2.0 默认：0.6 地平线 数值 效果1时有效,设置碎片落地的y轴坐标 地平线偏移 数值 效果1时有效,碎片落地的y坐标是否具有随机性 发力点x 数值 效果2时有效,设置发力点坐标 发力点y 数值 效果2时有效,设置发力点坐标 同步消失 逻辑 是否全部碎片都停止后才开始消失 默认：false | 名称 |
| 抖动 | {延迟=0,抖动={时间=2000,幅度=10,对象=引擎.窗口.底部UI.动画框1}}, 名称 类型 说明描述 对象 组件对象 要被抖动的对象 时间 整数 持续时间 单位：毫秒 幅度 整数 抖动幅度 | 名称 |
| 闪电链 | 名称 类型 说明描述 起点x 数值 起点坐标 起点y 数值 终点x 数值 终点坐标 终点y 数值 持续时间 整数 单位：毫秒 默认：1000 节点数量 整数 默认：30 抖动幅度 整数 数值越大越剧烈 默认：100 宽度 数值 默认：2.5 颜色 RGBA 默认：RGBA(100, 180, 255,255) 光晕色 RGBA 默认：RGBA(100, 180, 255,80) 渐入 整数 默认：200 渐出 整数 默认：200 末端变细 逻辑 | 名称 |
| 图层 | 目标为角色时： `0` 身后 `1` 身前 默认： `1` 目标为地图时： `0` 地表 `1` 顶层 默认： `1` | 动画时有效 |

| 名称 | 类型 | 说明描述 |
| --- | --- | --- |
| 音效 | table{} | 一个由音效资源名组成的数组,随机播放其中一个 |
| 音量 | 整数 | 音量大小：0-100 默认：100。可选 |
| 音高 | 小数 | 越大声音越尖锐,默认：1.0。可选 |

| 名称 | 类型 | 说明描述 |
| --- | --- | --- |
| 动画 | 文本 | 动画写法：动画,动作,缩放,速度,位置 |
| x | 整数 | 可选 |
| y | 整数 | 可选 |

| 名称 | 类型 | 说明描述 |
| --- | --- | --- |
| Call | function | |
| 附加 | 通用 | 触发时候,会做为Call的回调参数进行传递 |

| 名称 | 类型 | 说明描述 |
| --- | --- | --- |
| 效果 | 整数 | 0：向上抛出 1：中心炸开 2：角度冲击 |
| 数量 | 整数 | 碎片数量 默认：20 |
| 缩放 | 小数 | 缩放比例 默认：0.8 |
| 力量 | 小数 | 破碎爆出力度 范围：0.3-2.0 默认：0.6 |
| 地平线 | 数值 | 效果1时有效,设置碎片落地的y轴坐标 |
| 地平线偏移 | 数值 | 效果1时有效,碎片落地的y坐标是否具有随机性 |
| 发力点x | 数值 | 效果2时有效,设置发力点坐标 |
| 发力点y | 数值 | 效果2时有效,设置发力点坐标 |
| 同步消失 | 逻辑 | 是否全部碎片都停止后才开始消失 默认：false |

| 名称 | 类型 | 说明描述 |
| --- | --- | --- |
| 对象 | 组件对象 | 要被抖动的对象 |
| 时间 | 整数 | 持续时间 单位：毫秒 |
| 幅度 | 整数 | 抖动幅度 |

| 名称 | 类型 | 说明描述 |
| --- | --- | --- |
| 起点x | 数值 | 起点坐标 |
| 起点y | 数值 | |
| 终点x | 数值 | 终点坐标 |
| 终点y | 数值 | |
| 持续时间 | 整数 | 单位：毫秒 默认：1000 |
| 节点数量 | 整数 | 默认：30 |
| 抖动幅度 | 整数 | 数值越大越剧烈 默认：100 |
| 宽度 | 数值 | 默认：2.5 |
| 颜色 | RGBA | 默认：RGBA(100, 180, 255,255) |
| 光晕色 | RGBA | 默认：RGBA(100, 180, 255,80) |
| 渐入 | 整数 | 默认：200 |
| 渐出 | 整数 | 默认：200 |
| 末端变细 | 逻辑 | |

- 目标为角色时：0身后1身前  默认：1
- 目标为地图时：0地表1顶层  默认：1

## 示例

```
引擎.播放特效(512,100,{{延迟=200,音效={"雷电术_结束"}},{延迟=200,动画="雷电术,命中"}})
引擎.播放特效(200,200,{{延迟=200,音效={"雷电术_结束"}},{延迟=200,动画="雷电术,命中"}},引擎.窗口.技能窗口)
引擎.播放特效(0,0,{{延迟=200,音效={"升级光"}},{延迟=200,动画="__测试动画_,升级地,1,1",图层=0}},引擎.地图.主角)
引擎.播放特效(0,0,{{延迟=0,抖动={时间=2000,幅度=10,对象=引擎.窗口.底部UI.动画框1}}})
引擎.播放特效(0,0,{{延迟=0,音量=50,音效={"移动1","移动2"}}}

引擎.播放特效(200,200,
{
 {延迟=0,闪电链={起点x = 50,起点y = 50,终点x = 250,终点y = 50,持续时间 = 2000,宽度 = 1,颜色 = RGBA(240, 240, 240,255),
 光晕色 = RGBA(0, 0,255,255),渐入 = 100,渐出 = 100,节点数量 = 16,末端变细 = false}},
},按钮对象.父窗口)

{
 名称 = "测试按钮",
 类型 = "按钮",
 x = 40,
 y = 550,
 宽度 = 80,
 高度 = 40,
 标题 = "测试",
 系统事件 = {
 点击 = function(按钮对象)
 引擎.播放特效(400,300,{
 {
 延迟=0,
 破碎={
 图片="牌背面",
 数量=20,
 缩放=0.8,
 力量 = 1.6,
 效果=2,
 发力点x = 300, -- 从坐标300,300位置产生力量撕碎图片抛出。
 发力点y = 300,
 }
 }
 })
 end
 }
},

```

### 信息框

说明：在屏幕上弹出一个信息框。

参数名称 值的类型 是否必填 说明描述 内容 文本 true 支持丰富文本 按钮类型 整数 true `0 确定` `1 确定取消` `2 输入框+确定取消` 额外配置 table false 名称 类型 说明描述 确定按钮标题 文本 默认：确定 取消按钮标题 文本 默认：取消 确定按钮宽度 整数 默认：60 取消按钮宽度 整数 默认：60 确定按钮高度 整数 默认：30 取消按钮高度 整数 默认：30 背景遮罩透明度 整数 [0-255] 默认：168 默认内容 文本 输入框模式下的默认内容 示例 `if (引擎.信息框("确定要退出游戏吗?",1)) then `

 if(not 引擎.信息框("#Y你真的要退出?",1)) then
 引擎.信息框("#H你还是放弃了")
 end
end

local 结果,内容 = 引擎.信息框("输入动作名称",2,{默认内容="停止"})
if (结果) then
 调试输出(内容)
end

| 返回值 | 值的类型 | 说明描述 |
| --- | --- | --- |
| 是否确定 | 逻辑 | 确定返回true 取消返回false |
| 输入框内容 | 文本 | 输入框模式时返回内容 |

| 参数名称 | 值的类型 | 是否必填 | 说明描述 |
| --- | --- | --- | --- |
| 内容 | 文本 | true | 支持丰富文本 |
| 按钮类型 | 整数 | true | `0 确定` `1 确定取消` `2 输入框+确定取消` |
| 额外配置 | table | false | 名称 类型 说明描述 确定按钮标题 文本 默认：确定 取消按钮标题 文本 默认：取消 确定按钮宽度 整数 默认：60 取消按钮宽度 整数 默认：60 确定按钮高度 整数 默认：30 取消按钮高度 整数 默认：30 背景遮罩透明度 整数 [0-255] 默认：168 默认内容 文本 输入框模式下的默认内容 |

| 名称 | 类型 | 说明描述 |
| --- | --- | --- |
| 确定按钮标题 | 文本 | 默认：确定 |
| 取消按钮标题 | 文本 | 默认：取消 |
| 确定按钮宽度 | 整数 | 默认：60 |
| 取消按钮宽度 | 整数 | 默认：60 |
| 确定按钮高度 | 整数 | 默认：30 |
| 取消按钮高度 | 整数 | 默认：30 |
| 背景遮罩透明度 | 整数 [0-255] | 默认：168 |
| 默认内容 | 文本 | 输入框模式下的默认内容 |

## 示例

```
if (引擎.信息框("确定要退出游戏吗?",1)) then
 if(not 引擎.信息框("#Y你真的要退出?",1)) then
 引擎.信息框("#H你还是放弃了")
 end
end

local 结果,内容 = 引擎.信息框("输入动作名称",2,{默认内容="停止"})
if (结果) then
 调试输出(内容)
end

```

| 返回值 | 值的类型 | 说明描述 |
| --- | --- | --- |
| 是否确定 | 逻辑 | 确定返回true 取消返回false |
| 输入框内容 | 文本 | 输入框模式时返回内容 |

### 对话

说明：在屏幕上弹出一个对话框。 对话窗口使用App.lua中 `对话框` 皮肤。 对话链接触发的是当前对象中的 `系统事件` 中的同名事件, 链接名称为 `exit` 时,点击后关闭对话框。 事件函数会接收回调参数[信息],与 `文本框` 控件相同和调用时传递的[数据源]。 事件函数返回值为逻辑型 `true` 时,表示关闭对话窗口。 事件函数返回值为文本型,表示更新当前对话窗口内容。

参数名称 值的类型 是否必填 说明描述 x 整数/nil true 对话窗口坐标x,nil表示关闭对话窗口 y 整数 true 对话窗口坐标y 标题 文本 true 对话窗口有标题时有效 内容 文本 true 对话框中的内容,支持丰富文本 数据源 table false 会传递到事件函数中 示例 `{`

 名称 = "测试按钮",
 类型 = "按钮",
 宽度 = 80,
 高度 = 30,
 标题 = "测试对话",
 x = 692,
 y = 41,
 系统事件 = {

 点击 = function(按钮对象)

 引擎.对话(0,0,"",
 [[
 你要干什么？

 #Y#@查金币@我还有多少金币？@

 #Y#@exit@没事@

 ]])

 end,

 查金币 = function (信息,数据源)
 return
 [[
 你现在的金币数量：#Y999

 #Y#@退出@谢谢你@
 ]]
 end,

 退出 = function ()
 return true
 end,
 }
}

- 对话窗口使用App.lua中对话框皮肤。
- 对话链接触发的是当前对象中的系统事件中的同名事件, 链接名称为exit时,点击后关闭对话框。
- 事件函数会接收回调参数[信息],与文本框控件相同和调用时传递的[数据源]。
- 事件函数返回值为逻辑型true时,表示关闭对话窗口。
- 事件函数返回值为文本型,表示更新当前对话窗口内容。

| 参数名称 | 值的类型 | 是否必填 | 说明描述 |
| --- | --- | --- | --- |
| x | 整数/nil | true | 对话窗口坐标x,nil表示关闭对话窗口 |
| y | 整数 | true | 对话窗口坐标y |
| 标题 | 文本 | true | 对话窗口有标题时有效 |
| 内容 | 文本 | true | 对话框中的内容,支持丰富文本 |
| 数据源 | table | false | 会传递到事件函数中 |

## 示例

```
{

 名称 = "测试按钮",
 类型 = "按钮",
 宽度 = 80,
 高度 = 30,
 标题 = "测试对话",
 x = 692,
 y = 41,
 系统事件 = {

 点击 = function(按钮对象)

 引擎.对话(0,0,"",
 [[
 你要干什么？

 #Y#@查金币@我还有多少金币？@

 #Y#@exit@没事@

 ]])

 end,

 查金币 = function (信息,数据源)
 return
 [[
 你现在的金币数量：#Y999

 #Y#@退出@谢谢你@
 ]]
 end,

 退出 = function ()
 return true
 end,
 }
}

```

### 引导

说明：在屏幕上突出显示指定的控件。

参数名称 值的类型 是否必填 说明描述 控件数组 table{控件对象} true 示例 `local 窗口对象 = 引擎.窗口.底部UI`

窗口对象.引导动画.可视 = true
窗口对象.引导动画.x = 150
引擎.引导({窗口对象.底部红血条,窗口对象.生命标签,窗口对象.引导动画})
窗口对象.引导动画.x = 505
引擎.引导({窗口对象.属性按钮,窗口对象.引导动画})
窗口对象.引导动画.x = 585
引擎.引导({窗口对象.技能按钮,窗口对象.引导动画})
窗口对象.引导动画.可视 = false

| 参数名称 | 值的类型 | 是否必填 | 说明描述 |
| --- | --- | --- | --- |
| 控件数组 | table{控件对象} | true | |

## 示例

```
local 窗口对象 = 引擎.窗口.底部UI
窗口对象.引导动画.可视 = true
窗口对象.引导动画.x = 150
引擎.引导({窗口对象.底部红血条,窗口对象.生命标签,窗口对象.引导动画})
窗口对象.引导动画.x = 505
引擎.引导({窗口对象.属性按钮,窗口对象.引导动画})
窗口对象.引导动画.x = 585
引擎.引导({窗口对象.技能按钮,窗口对象.引导动画})
窗口对象.引导动画.可视 = false

```

### 增加物品

说明：增加物品道具到包裹格子中。

参数名称 值的类型 是否必填 说明描述 道具名称 文本 true 数量 整数 false 附加 table false 如果填写会传递到道具的 创建 事件中 示例 `引擎.增加物品("八荒刀",1,{攻击=20})`

引擎.增加物品("粗布衣",1,{给白装=true})
引擎.增加物品("金创药小",6)
引擎.增加物品("魔法药小",6)
引擎.增加物品("金创药中",6)
引擎.增加物品("魔法药中",26)
引擎.增加物品("雷电术")

| 参数名称 | 值的类型 | 是否必填 | 说明描述 |
| --- | --- | --- | --- |
| 道具名称 | 文本 | true | |
| 数量 | 整数 | false | |
| 附加 | table | false | 如果填写会传递到道具的 创建 事件中 |

## 示例

```
引擎.增加物品("八荒刀",1,{攻击=20})
引擎.增加物品("粗布衣",1,{给白装=true})
引擎.增加物品("金创药小",6)
引擎.增加物品("魔法药小",6)
引擎.增加物品("金创药中",6)
引擎.增加物品("魔法药中",26)
引擎.增加物品("雷电术")

```

### 取包裹空位

说明：取所有包裹类控件剩余的空位数量。

参数名称 值的类型 是否必填 说明描述 包裹名称 文本 false nil表示取所有包裹空位 示例 `local 剩余空位 = 引擎.取包裹空位()`

调试输出(剩余空位)

| 返回值 | 值的类型 | 说明描述 |
| --- | --- | --- |
| 数量 | 整数 | |

| 参数名称 | 值的类型 | 是否必填 | 说明描述 |
| --- | --- | --- | --- |
| 包裹名称 | 文本 | false | nil表示取所有包裹空位 |

## 示例

```
local 剩余空位 = 引擎.取包裹空位()
调试输出(剩余空位)

```

| 返回值 | 值的类型 | 说明描述 |
| --- | --- | --- |
| 数量 | 整数 | |

### 取物品数量

说明：取包裹中指定物品的总数量。

参数名称 值的类型 是否必填 说明描述 道具名称 文本 true 示例 `local 物品数量 = 引擎.取物品数量("金创药小")`

调试输出(物品数量)

| 返回值 | 值的类型 | 说明描述 |
| --- | --- | --- |
| 数量 | 整数 | |

| 参数名称 | 值的类型 | 是否必填 | 说明描述 |
| --- | --- | --- | --- |
| 道具名称 | 文本 | true | |

## 示例

```
local 物品数量 = 引擎.取物品数量("金创药小")
调试输出(物品数量)

```

| 返回值 | 值的类型 | 说明描述 |
| --- | --- | --- |
| 数量 | 整数 | |

### 减少物品

说明：从包裹格子里面减少物品。

参数名称 值的类型 是否必填 说明描述 道具名称 文本 true 数量 整数 true 示例 `引擎.减少物品("金创药小",2)`

| 参数名称 | 值的类型 | 是否必填 | 说明描述 |
| --- | --- | --- | --- |
| 道具名称 | 文本 | true | |
| 数量 | 整数 | true | |

## 示例

```
引擎.减少物品("金创药小",2)

```

### 创建音乐

说明：创建一个 音乐对象 。

参数名称 值的类型 是否必填 说明描述 音乐素材 文本 true 音乐资源素材标识 示例 `local 背景音乐 = 引擎.创建音乐("一直很安静")`

背景音乐.音量 = 50
背景音乐.循环 = true
背景音乐.播放()

| 返回值 | 值的类型 | 说明描述 |
| --- | --- | --- |
| 对象 | 音乐对象 | |

说明：创建一个音乐对象。

| 参数名称 | 值的类型 | 是否必填 | 说明描述 |
| --- | --- | --- | --- |
| 音乐素材 | 文本 | true | 音乐资源素材标识 |

## 示例

```
local 背景音乐 = 引擎.创建音乐("一直很安静")
背景音乐.音量 = 50
背景音乐.循环 = true
背景音乐.播放()

```

| 返回值 | 值的类型 | 说明描述 |
| --- | --- | --- |
| 对象 | 音乐对象 | |

### 创建缓动

说明：创建一个 缓动对象 。

参数名称 值的类型 是否必填 说明描述 自动销毁 逻辑 false 默认：true 示例 `引擎.创建缓动()`

.by(按钮对象.父窗口.地图按钮,{y=-100,x=100},500)
.by(按钮对象.父窗口.地图按钮,{y=100,x=-100},500)

| 返回值 | 值的类型 | 说明描述 |
| --- | --- | --- |
| 对象 | 缓动对象 | 支持链式调用 |

说明：创建一个缓动对象。

| 参数名称 | 值的类型 | 是否必填 | 说明描述 |
| --- | --- | --- | --- |
| 自动销毁 | 逻辑 | false | 默认：true |

## 示例

```
引擎.创建缓动()
.by(按钮对象.父窗口.地图按钮,{y=-100,x=100},500)
.by(按钮对象.父窗口.地图按钮,{y=100,x=-100},500)

```

| 返回值 | 值的类型 | 说明描述 |
| --- | --- | --- |
| 对象 | 缓动对象 | 支持链式调用 |

### 添加指针

说明：使用组件自定义指针样式,通过 `引擎.鼠标指针` 动态显示。

参数名称 值的类型 是否必填 说明描述 组件配置 table true `精灵,动画...等基石组件` 示例 `引擎.添加指针(`

 {
 名称 = "指针默认",
 类型 = "精灵",
 图片 = "鼠标指针_默认"
 }
)

引擎.鼠标指针 = "指针默认"

说明：使用组件自定义指针样式,通过引擎.鼠标指针动态显示。

| 参数名称 | 值的类型 | 是否必填 | 说明描述 |
| --- | --- | --- | --- |
| 组件配置 | table | true | `精灵,动画...等基石组件` |

## 示例

```
引擎.添加指针(
 {
 名称 = "指针默认",
 类型 = "精灵",
 图片 = "鼠标指针_默认"
 }
)

引擎.鼠标指针 = "指针默认"

```

### 弹出菜单

说明：在鼠标位置弹出指定 菜单 项目。

参数名称 值的类型 是否必填 说明描述 菜单名称 文本 false 附加 通用 false 会传递到菜单点击事件中 屏幕坐标x 整数 false 屏幕坐标y 整数 false 示例 `引擎.弹出菜单("物件菜单")`

说明：在鼠标位置弹出指定菜单项目。

| 参数名称 | 值的类型 | 是否必填 | 说明描述 |
| --- | --- | --- | --- |
| 菜单名称 | 文本 | false | |
| 附加 | 通用 | false | 会传递到菜单点击事件中 |
| 屏幕坐标x | 整数 | false | |
| 屏幕坐标y | 整数 | false | |

## 示例

```
引擎.弹出菜单("物件菜单")

```

### 存档

说明：存档。

参数名称 值的类型 是否必填 说明描述 存档文件名 文本/nil true 存档到指定文件,如果为nil表示存档到table 附加 table false 需要保存的自定义数据 密钥 文本 false 不填表示不加密 示例 `local 结果 = 引擎.存档("save.dat",{金币=20,技能点=30},"ttttt")`

调试输出(结果)

local 结果 = 引擎.存档(nil,{金币=20,技能点=30},"ttttt")
调试输出(结果)

| 返回值 | 值的类型 | 说明描述 |
| --- | --- | --- |
| 结果 | 逻辑/table | 存档到文件失败返回false,存档到table格式为{ver,dat} |

| 参数名称 | 值的类型 | 是否必填 | 说明描述 |
| --- | --- | --- | --- |
| 存档文件名 | 文本/nil | true | 存档到指定文件,如果为nil表示存档到table |
| 附加 | table | false | 需要保存的自定义数据 |
| 密钥 | 文本 | false | 不填表示不加密 |

## 示例

```
local 结果 = 引擎.存档("save.dat",{金币=20,技能点=30},"ttttt")
调试输出(结果)

local 结果 = 引擎.存档(nil,{金币=20,技能点=30},"ttttt")
调试输出(结果)

```

| 返回值 | 值的类型 | 说明描述 |
| --- | --- | --- |
| 结果 | 逻辑/table | 存档到文件失败返回false,存档到table格式为{ver,dat} |

提示

默认存读档的内容：包裹格子，道具格子，技能格子，快捷格子，主角所在的地图,位置,方向,等级,经验。

### 读档

说明：读档。

参数名称 值的类型 是否必填 说明描述 存档文件名/存档信息 文本/table true 存档保存的位置或者存档table信息 密钥 文本 false 不填表示不加密 配置 table false 成员 类型 说明 跳转地图 逻辑 是否跳转到存档时的地图 默认：true 示例 `local 附加 = 引擎.读档("save.dat","ttttt")`

调试输出("读档",附加)

-- 从table中还原存档
local 结果 = 引擎.存档(nil,{金币=20,技能点=30},"ttttt")
附加 = 引擎.读档(结果,"ttttt")
调试输出("读档",附加)

| 返回值 | 值的类型 | 说明描述 |
| --- | --- | --- |
| 附加 | table/nil | 读档成功返回存档时传递进去的数据,失败返回nil |

| 参数名称 | 值的类型 | 是否必填 | 说明描述 |
| --- | --- | --- | --- |
| 存档文件名/存档信息 | 文本/table | true | 存档保存的位置或者存档table信息 |
| 密钥 | 文本 | false | 不填表示不加密 |
| 配置 | table | false | 成员 类型 说明 跳转地图 逻辑 是否跳转到存档时的地图 默认：true |

| 成员 | 类型 | 说明 |
| --- | --- | --- |
| 跳转地图 | 逻辑 | 是否跳转到存档时的地图 默认：true |

## 示例

```
local 附加 = 引擎.读档("save.dat","ttttt")
调试输出("读档",附加)

-- 从table中还原存档
local 结果 = 引擎.存档(nil,{金币=20,技能点=30},"ttttt")
附加 = 引擎.读档(结果,"ttttt")
调试输出("读档",附加)

```

| 返回值 | 值的类型 | 说明描述 |
| --- | --- | --- |
| 附加 | table/nil | 读档成功返回存档时传递进去的数据,失败返回nil |

### 结束

说明：立即关闭游戏，不会触发 `游戏关闭` 事件。

示例 `引擎.结束() `

## 示例

```
引擎.结束()

```

### 执行

说明：调用Windows系统通用接口。

命令名称 参数表 说明描述 打开文件 属性 类型 是否必填 说明 初始目录 文本 false 默认：程序运行目录 多选 逻辑 false 默认：false 过滤器 文本 false 默认："所有文件\|*.*\|" 显示系统打开文件对话框,返回选中的所有文件名 保存文件 属性 类型 是否必填 说明 初始目录 文本 false 默认：程序运行目录 后缀名 文本 false 缺省情况下的后缀名例："json" 过滤器 文本 false 默认："所有文件\|*.*\|" 显示系统保存文件对话框,返回保存的文件名 查看文件 属性 类型 是否必填 说明 文件 文本 true 指定文件名或是目录 打开文件夹并且选中文件 删除文件 属性 类型 是否必填 说明 文件 文本 true 指定文件名或是目录 删除文件或者文件夹 寻找文件 属性 类型 是否必填 说明 文件 文本 true 支持通配符 寻找指定文件,返回文件名数组 复制文件 属性 类型 是否必填 说明 文件 文本 true 待复制文件名 目标 文本 true 目标文件名 复制指定文件到目标位置,自动创建目标目录 命令行 属性 类型 是否必填 说明 命令 文本 true 待指定的cmd命令 返回执行结果 屏幕截图 属性 类型 是否必填 说明 文件 文本 true 截图文件名支持.jpg .png 区域 table true {x,y,w,h} 屏幕截图并保存到指定文件 图片切片 属性 类型 是否必填 说明 文件 文本 true 图片文件地址 目标 文本 true 保存的目录 宽度 整数 true 单片宽度 默认：256 高度 整数 true 单片高度 默认：256 格式 文本 true 保存什么格式 默认："jpg" 将一张图片按需求裁剪成小块 失败返回nil 成功返回:{原图宽度,原图高度,列数,行数} 示例 `local 结果 = 引擎.执行("打开文件",{初始目录="./",多选=true,过滤器="Lua脚本\|*.lua\|图片文件\|*.jpg;*.png\|所有文件\|*.*\|"})`

调试输出(结果)

local 结果 = 引擎.执行("保存文件",{初始目录="E:/", 后缀名="dmp", 过滤器="Lua脚本|*.lua|图片文件|*.jpg;*.png|所有文件|*.*|"})
调试输出(结果)

引擎.执行("查看文件",{文件="C:/Users"})

引擎.执行("删除文件",{文件="D:/luamake"})

local 结果 = 引擎.执行("寻找文件",{文件 = "MapRes/高物件/*.png"})
for n=1,#结果 do
 local info = string.fileinfo(结果[n])
 调试输出(引擎.执行("复制文件",{文件 = 结果[n],目标 = "F:/dmstore/" .. info.文件名}))
end

引擎.执行("命令行",{命令="start http://dm3.2ddm.com/"})

引擎.执行("屏幕截图",{文件= "游戏截图.jpg",区域={0,0,引擎.系统信息.屏幕宽度,引擎.系统信息.屏幕高度}})

local 结果 = 引擎.执行("图片切片",{文件 = "gameMap.jpg",目标= "" ,宽度=256,高度=256,格式="jpg"})
调试输出(结果)

| 命令名称 | 参数表 | 说明描述 |
| --- | --- | --- |
| 打开文件 | 属性 类型 是否必填 说明 初始目录 文本 false 默认：程序运行目录 多选 逻辑 false 默认：false 过滤器 文本 false 默认："所有文件\|*.*\|" | 属性 |
| 保存文件 | 属性 类型 是否必填 说明 初始目录 文本 false 默认：程序运行目录 后缀名 文本 false 缺省情况下的后缀名例："json" 过滤器 文本 false 默认："所有文件\|*.*\|" | 属性 |
| 查看文件 | 属性 类型 是否必填 说明 文件 文本 true 指定文件名或是目录 | 属性 |
| 删除文件 | 属性 类型 是否必填 说明 文件 文本 true 指定文件名或是目录 | 属性 |
| 寻找文件 | 属性 类型 是否必填 说明 文件 文本 true 支持通配符 | 属性 |
| 复制文件 | 属性 类型 是否必填 说明 文件 文本 true 待复制文件名 目标 文本 true 目标文件名 | 属性 |
| 命令行 | 属性 类型 是否必填 说明 命令 文本 true 待指定的cmd命令 | 属性 |
| 屏幕截图 | 属性 类型 是否必填 说明 文件 文本 true 截图文件名支持.jpg .png 区域 table true {x,y,w,h} | 属性 |
| 图片切片 | 属性 类型 是否必填 说明 文件 文本 true 图片文件地址 目标 文本 true 保存的目录 宽度 整数 true 单片宽度 默认：256 高度 整数 true 单片高度 默认：256 格式 文本 true 保存什么格式 默认："jpg" | 属性 |

| 属性 | 类型 | 是否必填 | 说明 |
| --- | --- | --- | --- |
| 初始目录 | 文本 | false | 默认：程序运行目录 |
| 多选 | 逻辑 | false | 默认：false |
| 过滤器 | 文本 | false | 默认："所有文件\|*.*\|" |

| 属性 | 类型 | 是否必填 | 说明 |
| --- | --- | --- | --- |
| 初始目录 | 文本 | false | 默认：程序运行目录 |
| 后缀名 | 文本 | false | 缺省情况下的后缀名例："json" |
| 过滤器 | 文本 | false | 默认："所有文件\|*.*\|" |

| 属性 | 类型 | 是否必填 | 说明 |
| --- | --- | --- | --- |
| 文件 | 文本 | true | 指定文件名或是目录 |

| 属性 | 类型 | 是否必填 | 说明 |
| --- | --- | --- | --- |
| 文件 | 文本 | true | 指定文件名或是目录 |

| 属性 | 类型 | 是否必填 | 说明 |
| --- | --- | --- | --- |
| 文件 | 文本 | true | 支持通配符 |

| 属性 | 类型 | 是否必填 | 说明 |
| --- | --- | --- | --- |
| 文件 | 文本 | true | 待复制文件名 |
| 目标 | 文本 | true | 目标文件名 |

| 属性 | 类型 | 是否必填 | 说明 |
| --- | --- | --- | --- |
| 命令 | 文本 | true | 待指定的cmd命令 |

| 属性 | 类型 | 是否必填 | 说明 |
| --- | --- | --- | --- |
| 文件 | 文本 | true | 截图文件名支持.jpg .png |
| 区域 | table | true | {x,y,w,h} |

| 属性 | 类型 | 是否必填 | 说明 |
| --- | --- | --- | --- |
| 文件 | 文本 | true | 图片文件地址 |
| 目标 | 文本 | true | 保存的目录 |
| 宽度 | 整数 | true | 单片宽度 默认：256 |
| 高度 | 整数 | true | 单片高度 默认：256 |
| 格式 | 文本 | true | 保存什么格式 默认："jpg" |

## 示例

```
local 结果 = 引擎.执行("打开文件",{初始目录="./",多选=true,过滤器="Lua脚本|*.lua|图片文件|*.jpg;*.png|所有文件|*.*|"})
调试输出(结果)

local 结果 = 引擎.执行("保存文件",{初始目录="E:/", 后缀名="dmp", 过滤器="Lua脚本|*.lua|图片文件|*.jpg;*.png|所有文件|*.*|"})
调试输出(结果)

引擎.执行("查看文件",{文件="C:/Users"})

引擎.执行("删除文件",{文件="D:/luamake"})

local 结果 = 引擎.执行("寻找文件",{文件 = "MapRes/高物件/*.png"})
for n=1,#结果 do
 local info = string.fileinfo(结果[n])
 调试输出(引擎.执行("复制文件",{文件 = 结果[n],目标 = "F:/dmstore/" .. info.文件名}))
end

引擎.执行("命令行",{命令="start http://dm3.2ddm.com/"})

引擎.执行("屏幕截图",{文件= "游戏截图.jpg",区域={0,0,引擎.系统信息.屏幕宽度,引擎.系统信息.屏幕高度}})

local 结果 = 引擎.执行("图片切片",{文件 = "gameMap.jpg",目标= "" ,宽度=256,高度=256,格式="jpg"})
调试输出(结果)

```

### 资源解析

资源解析

说明：用于查看图集,动画,地图模板资源内部信息。

参数名称 值的类型 是否必填 说明描述 资源标识 文本 true 示例 `local 资源信息 = 引擎.资源解析(素材标识)`

调试输出(资源信息)

| 返回值 | 值的类型 | 说明描述 |
| --- | --- | --- |
| 结果 | table/nil | 失败返回nil {类型,数据={}} 图集数据 {帧名称,帧宽度,帧高度,帧偏移x,帧偏移y} 动画数据 {动作名称} 地图数据 {格子宽度,格子高度,格子列数,格子行数,障碍信息} |

| 参数名称 | 值的类型 | 是否必填 | 说明描述 |
| --- | --- | --- | --- |
| 资源标识 | 文本 | true | |

## 示例

```
local 资源信息 = 引擎.资源解析(素材标识)
调试输出(资源信息)

```

| 返回值 | 值的类型 | 说明描述 |
| --- | --- | --- |
| 结果 | table/nil | 失败返回nil {类型,数据={}} 图集数据 {帧名称,帧宽度,帧高度,帧偏移x,帧偏移y} 动画数据 {动作名称} 地图数据 {格子宽度,格子高度,格子列数,格子行数,障碍信息} |

- {类型,数据={}}
- 图集数据 {帧名称,帧宽度,帧高度,帧偏移x,帧偏移y}
- 动画数据 {动作名称}
- 地图数据 {格子宽度,格子高度,格子列数,格子行数,障碍信息}

### 加入事件

加入事件

说明：往游戏主循环中加入一个自定义事件。

参数名称 值的类型 是否必填 说明描述 事件名称 文本 true 触发的事件名称 附加信息 table false 事件触发时可以取出 延迟时间 数值 false 延迟执行 自动销毁 逻辑 false 是否只执行一次，默认：true 示例 `系统事件 = {`

 游戏开始 = function()
 引擎.加入事件("系统时钟",{},1000,false)
 end,

 系统时钟 = function (tbl,dt,time)
 调试输出(dt,time)
 end,

}

| 参数名称 | 值的类型 | 是否必填 | 说明描述 |
| --- | --- | --- | --- |
| 事件名称 | 文本 | true | 触发的事件名称 |
| 附加信息 | table | false | 事件触发时可以取出 |
| 延迟时间 | 数值 | false | 延迟执行 |
| 自动销毁 | 逻辑 | false | 是否只执行一次，默认：true |

## 示例

```
系统事件 = {

 游戏开始 = function()
 引擎.加入事件("系统时钟",{},1000,false)
 end,

 系统时钟 = function (tbl,dt,time)
 调试输出(dt,time)
 end,

}

```

### 删除事件

删除事件

说明：删除指定自定义事件。

参数名称 值的类型 是否必填 说明描述 事件名称 文本 true 示例 `系统事件 = {`

 游戏开始 = function()
 引擎.加入事件("系统时钟",{},1000,false)
 end,

 系统时钟 = function (tbl,dt,time)
 调试输出(dt,time)
 引擎.删除事件("系统时钟")
 end,

}

| 参数名称 | 值的类型 | 是否必填 | 说明描述 |
| --- | --- | --- | --- |
| 事件名称 | 文本 | true | |

## 示例

```
系统事件 = {

 游戏开始 = function()
 引擎.加入事件("系统时钟",{},1000,false)
 end,

 系统时钟 = function (tbl,dt,time)
 调试输出(dt,time)
 引擎.删除事件("系统时钟")
 end,

}

```
